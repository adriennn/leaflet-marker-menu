!function(){function t(t,e,i){for(var s=0,n=t.length;n>s;s++)e.call(i||null,t[s],s,t)}L.MarkerMenu=L.Class.extend({includes:L.Mixin.Events,options:{pane:"menuPane",radius:100,animate:!0,duration:200,size:[24,24]},initialize:function(t,e){L.setOptions(this,t),this._items=[],this._menuList=null,this._menuItems=[],this._appendItems(this.options.items),this._source=e,this._isOpened=!1},hide:function(){this._container.style.display="none"},show:function(){this._container.style.display="block"},getItems:function(){return this._items},append:function(t){t instanceof L.MarkerMenu?this._appendItems(t.getItems()):this._appendItems(t)},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=t,this._map&&this._updatePosition(),this},onAdd:function(t){this._map=t,this._container||(this._initLayout(),this._updateMenu()),t.on("zoomstart",this._onZoomStart,this),t.on("zoomend",this._onZoomEnd,this),this._updatePosition(),t.getPanes().markerPane.appendChild(this._container),this._source&&this._source.fire("menuopen",{menu:this})},onRemove:function(t){var e=this;this._resetItemsPositions(),t.off("zoomstart",this._onZoomStart),t.off("zoomend",this._onZoomEnd),setTimeout(function(){e._map=null,t.getPanes().markerPane.removeChild(e._container),e._source&&e._source.fire("menuclose",{menu:e})},this.options.duration)},_onZoomStart:function(){this.hide()},_onZoomEnd:function(){this._updatePosition(),this.show()},_appendItems:function(e){t(e,function(t){this._items.push(t)},this),this._updateMenu(),this._updatePosition()},_initLayout:function(){var t="leaflet-marker-menu";this._container=L.DomUtil.create("div",t+" "+(this.options.className||"")+" leaflet-zoom-hide"),this._container.style.zIndex=-1,this._container.style.position="absolute"},_updateMenu:function(){if(this._container){var e="leaflet-marker-menu-item";this._menuList&&this._container.removeChild(this._menuList),this._menuList=L.DomUtil.create("ul","",this._container),this._menuItems=[],this._menuList.style.listStyle="none",this._menuList.style.padding=0,this._menuList.style.margin=0,this._menuList.style.position="relative",this._menuList.style.width=this.options.size[0]+"px",this._menuList.style.height=this.options.size[1]+"px",t(this._items,function(t){var i=L.DomUtil.create("li","",this._menuList),s=L.DomUtil.create("a",e+" "+(this.options.itemClassName||"")+" "+(t.className||""),i);s.style.width=this.options.size[0]+"px",s.style.height=this.options.size[1]+"px",s.style.display="block",s.style.cursor="pointer",s.title=t.title,i.style.zIndex=1e7,i.style.position="absolute",this.options.animate&&(i.style.left=0,i.style.bottom=0,L.DomUtil.setOpacity(i,0),i.style[L.DomUtil.TRANSITION]="all "+this.options.duration/1e3+"s"),L.DomEvent.addListener(s,"click",t.click,t),this._menuItems.push(i)},this),this._menuItems.reverse()}},_resetItemsPositions:function(){t(this._menuItems,function(t){t.style.left=0,t.style.bottom=0,L.DomUtil.setOpacity(t,0)},this)},_updatePosition:function(){if(this._map){var e=this._map.latLngToLayerPoint(this._latlng),i=L.point(this.options.offset||[0,0]),s=this._container,n=(s.style,Math.PI/(this._menuItems.length+1)),o=this.options.radius,h=this,u=this._containerBottom=-i.y-e.y,a=this._containerLeft=i.x+e.x;this._container.style.bottom=u+this.options.size[1]/2+"px",this._container.style.left=a-this.options.size[0]/2+"px",setTimeout(function(){t(h._menuItems,function(t,e){var i=Math.cos(n*(e+1))*o,s=Math.sin(n*(e+1))*o;t.style.left=Math.round(i)+"px",t.style.bottom=Math.round(s)+"px",L.DomUtil.setOpacity(t,1)},this)},0)}},_resetPosition:function(){t(this._menuItems,function(t){t.style.left="0px",t.style.bottom="0px",L.DomUtil.setOpacity(t,0)},this)}}),L.markerMenu=function(t,e){return new L.MarkerMenu(t,e)},L.Marker.include({openMenu:function(){return this._menu?(this._menu.setLatLng(this._latlng),this._menu._isOpened=!0,this._map.addLayer(this._menu),this):void 0},closeMenu:function(){this._menu&&(this._map.removeLayer(this._menu),this._menu._isOpened=!1)},toggleMenu:function(){this._menu&&(this._menu._isOpened?this.closeMenu():this.openMenu())},getMenu:function(){return this._menu},setMenu:function(t){if(!(!t instanceof L.MarkerMenu&&0===t.items.length)){this._menu&&this.removeMenu(),this._menu=t instanceof L.MarkerMenu?t:L.markerMenu(t,this),this.on("click",this.toggleMenu,this),this.on("move",this._moveMenu,this),this.on("remove",this.closeMenu,this)}},removeMenu:function(){this._menu&&(this.off("click",this.toggleMenu),this.off("move",this._moveMenu),this.off("remove",this.closeMenu),this._closeMenu(),this._menu=null)},_moveMenu:function(){this._menu&&this._menu.setLatLng(this._latlng)}})}();